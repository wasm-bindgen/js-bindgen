<!doctype html>
<meta charset="utf-8" />
<title>js-bindgen test</title>
<pre id="output"></pre>
<script type="module">
	import {{ runBrowser }} from "/browser-runner.mjs";

	const filtered = {filtered_count};
	const noCapture = {no_capture_flag};
	const worker = {worker};

    window.reportLines = []

    window.takeReportLines = () => {{
        const lines = window.reportLines
        window.reportLines = []
        return lines
    }}

    window.pushReportLines = line => {{
        window.reportLines.push(line)
    }}

	const result = await runBrowser({{ filtered, noCapture, worker }});
	await fetch("/report", {{
		method: "POST",
		headers: {{ "content-type": "application/json" }},
	    body: JSON.stringify(result),
	}});
</script>
